(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{39:function(e,t,a){e.exports={loader:"styles_loader__219aS",load8:"styles_load8__jKT1m"}},76:function(e,t,a){"use strict";a.r(t);var r,s=a(1),c=a.n(s),n=a(19),i=a.n(n),o=a(4),l=a(37),u=a.n(l),d="six-cities-auth-token",j=function(e){localStorage.setItem(d,e)};!function(e){e[e.Unauthorized=401]="Unauthorized"}(r||(r={}));var p,b=a(2),f=a(6),m="/",_="/login",h="/offer",O="/favorites",v="/not-found";!function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(p||(p={}));var x,g={APARTMENT:"Apartment",ROOM:"Private room",HOUSE:"House",HOTEL:"Hotel"},N=["Paris","Cologne","Brussels","Amsterdam","Hamburg","Dusseldorf"],y=function(e,t){if(e<0||t<0)return 0;if(e>t){var a=[t,e];e=a[0],t=a[1]}return Math.round(Math.random()*(t-e)+e)},w="./img/pin.svg",E="./img/pin-active.svg",R="cities",k="favorites",S="near-places",C=260,A=200,F=150,P=110,T="Popular",I="Price: low to high",U="Price: high to low",D="Top rated first",M="/hotels",H="/login",G="/logout",L="/comments",V="/favorite",W=function(e){var t=Object.assign({},e,{isFavorite:e.is_favorite,isPremium:e.is_premium,maxAdults:e.max_adults,previewImage:e.preview_image,host:{avatarUrl:e.host.avatar_url,id:e.host.id,isPro:e.host.is_pro,name:e.host.name}});return delete t.is_favorite,delete t.is_premium,delete t.max_adults,delete t.preview_image,delete t.host.avatar_url,delete t.host.is_pro,t},z=function(e){var t=Object.assign({},e,{user:{avatarUrl:e.user.avatar_url,id:e.user.id,isPro:e.user.is_pro,name:e.user.name}});return delete t.user.avatar_url,delete t.user.is_pro,t};!function(e){e.GetCityAction="MAIN/GET_CITY",e.GetOffersAction="MAIN/GET_OFFERS",e.GetOfferByIDAction="OFFERS/GET_OFFER",e.ClearOfferByIDAction="OFFERS/CLEAR_OFFER",e.GetNearByOffers="OFFERS/GET_NEARBY",e.GetReviews="OFFERS/GET_REVIEWS",e.PostReview="OFFERS/POST_REVIEW",e.PostError="OFFERS/POST_REVIEW_ERROR",e.ClearPostReviewStatus="OFFERS/CLEAR_POST_REVIEW_STATUS",e.ClearPostReviewError="OFFERS/CLEAR_POST_REVIEW_ERROR",e.GetFavoriteOffers="FAVORITE/GET_FAVORITE_OFFERS",e.ClearFavoriteOffers="FAVORITE/CLEAR_FAVORITE_OFFERS",e.AddToFavoriteOffers="FAVORITE/ADD_TO_FAVORITE",e.RemoveFromFavoriteOffers="FAVORITE/REMOVE_FROM_FAVORITE",e.RequireAuthorization="USER/REQUIRE_AUTHORIZATION",e.RequireLogout="USER/REQUIRE_LOGOUT",e.RedirectToRoute="USER/REDIRECT"}(x||(x={}));var B,q,Y=1,J=0,K={EMAIL:/[^@\s]+@[^@\s]+\.[^@\s]+$/,PASSWORD:/^(?=.*\d)(?=.*[a-zA-Z])/},Q="Unable to send the message. Check your internet connection",Z="Unable to add to favorites. Check your internet connection",$="Unable to remove from favorites. Check your internet connection",X=Object(o.b)(x.GetCityAction,(function(e){return{payload:{city:e}}})),ee=Object(o.b)(x.GetOffersAction,(function(e){return{payload:{offers:e}}})),te=Object(o.b)(x.GetOfferByIDAction,(function(e){return{payload:{offer:e}}})),ae=Object(o.b)(x.ClearOfferByIDAction),re=Object(o.b)(x.GetNearByOffers,(function(e){return{payload:{offers:e}}})),se=Object(o.b)(x.GetReviews,(function(e){return{payload:{reviews:e}}})),ce=Object(o.b)(x.PostReview,(function(e){return{payload:{reviews:e}}})),ne=Object(o.b)(x.PostError),ie=Object(o.b)(x.ClearPostReviewStatus),oe=Object(o.b)(x.ClearPostReviewError),le=Object(o.b)(x.GetFavoriteOffers,(function(e){return{payload:{favoriteOffers:e}}})),ue=Object(o.b)(x.ClearFavoriteOffers),de=Object(o.b)(x.AddToFavoriteOffers,(function(e){return{payload:{favoriteOffer:e}}})),je=Object(o.b)(x.RemoveFromFavoriteOffers,(function(e){return{payload:{favoriteOffer:e}}})),pe=Object(o.b)(x.RequireAuthorization,(function(e,t){return{payload:{authStatus:e,email:t}}})),be=Object(o.b)(x.RequireLogout),fe=Object(o.b)(x.RedirectToRoute,(function(e){return{payload:{url:e}}})),me=a(15),_e=a(7),he=a(21),Oe=a(12),ve={authorizationStatus:p.Unknown,userEmail:void 0},xe=Object(o.c)(ve,(function(e){e.addCase(pe,(function(e,t){e.authorizationStatus=t.payload.authStatus,e.userEmail=t.payload.email})).addCase(be,(function(e){e.authorizationStatus=p.NoAuth,e.userEmail=ve.userEmail}))})),ge={selectedCity:"Paris",offers:[],isDataLoaded:!1,offer:void 0,nearbyOffers:void 0,favoriteOffers:[]},Ne=Object(o.c)(ge,(function(e){e.addCase(X,(function(e,t){e.selectedCity=t.payload.city})).addCase(ee,(function(e,t){e.offers=t.payload.offers.map((function(e){return W(e)})),e.isDataLoaded=!0})).addCase(te,(function(e,t){e.offer=W(t.payload.offer)})).addCase(ae,(function(e){e.offer=ge.offer,e.nearbyOffers=ge.nearbyOffers})).addCase(re,(function(e,t){var a;e.nearbyOffers=null===(a=t.payload.offers)||void 0===a?void 0:a.map((function(e){return W(e)}))})).addCase(le,(function(e,t){var a;e.favoriteOffers=null===(a=t.payload.favoriteOffers)||void 0===a?void 0:a.map((function(e){return W(e)}))})).addCase(ue,(function(e){e.favoriteOffers=ge.favoriteOffers})).addCase(de,(function(e,t){var a=W(t.payload.favoriteOffer);e.favoriteOffers.push(a)})).addCase(je,(function(e,t){e.favoriteOffers=e.favoriteOffers.filter((function(e){return e.id!==t.payload.favoriteOffer.id}))}))})),ye={reviews:void 0,postSuccess:!1,postError:!1},we=Object(o.c)(ye,(function(e){e.addCase(se,(function(e,t){var a;e.reviews=null===(a=t.payload.reviews)||void 0===a?void 0:a.map((function(e){return z(e)}))})).addCase(ce,(function(e,t){var a;e.reviews=null===(a=t.payload.reviews)||void 0===a?void 0:a.map((function(e){return z(e)})),e.postSuccess=!0})).addCase(ne,(function(e){e.postError=!0})).addCase(ie,(function(e){e.postSuccess=ye.postSuccess})).addCase(oe,(function(e){e.postError=ye.postError}))}));!function(e){e.offers="OFFERS",e.reviews="REVIEWS",e.user="USER"}(q||(q={}));var Ee=Object(Oe.c)((B={},Object(he.a)(B,q.user,xe),Object(he.a)(B,q.offers,Ne),Object(he.a)(B,q.reviews,we),B)),Re=a(17),ke=function(e){return e[q.offers].offers},Se=function(e){return e[q.offers].isDataLoaded},Ce=function(e){return e[q.offers].selectedCity},Ae=function(e){return e[q.offers].offer},Fe=function(e){return e[q.offers].nearbyOffers},Pe=function(e){return e[q.offers].favoriteOffers},Te=function(e){return Object(Re.a)(Pe,(function(t){return(null===t||void 0===t?void 0:t.filter((function(t){return t.id===e})).length)>0}))},Ie=function(e){return e[q.user].authorizationStatus},Ue=function(e){return e[q.user].userEmail},De=a(5),Me=a.n(De),He=a(10),Ge=a(16),Le=function(){return function(){var e=Object(He.a)(Me.a.mark((function e(t,a,r){var s,c;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(V);case 2:s=e.sent,(c=s.data)&&t(le(c));case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()},Ve=function(e){return function(){var t=Object(He.a)(Me.a.mark((function t(a,r,s){var c,n;return Me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.post("".concat(V,"/").concat(e,"/").concat(Y));case 3:c=t.sent,n=c.data,a(de(n)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),Ge.b.info(Z);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,r){return t.apply(this,arguments)}}()},We=function(e){return function(){var t=Object(He.a)(Me.a.mark((function t(a,r,s){var c,n;return Me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.post("".concat(V,"/").concat(e,"/").concat(J));case 3:c=t.sent,n=c.data,a(je(n)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),Ge.b.info($);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,r){return t.apply(this,arguments)}}()},ze=function(e,t,a){return function(){var r=Object(He.a)(Me.a.mark((function r(s,c){return Me.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e!==p.Auth?s(fe(_)):s(t?We(a):Ve(a));case 1:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()},Be=a(0);function qe(e){var t=e.offer,a=e.listItemHoverHandler,r=e.isMainScreen,s=e.isFavoriteScreen,c=e.isPropertyScreen,n=t.isPremium,i=t.previewImage,o=t.title,l=t.price,u=t.rating,d=t.type,j=t.id,p=Object(b.c)(Te(j)),f=Object(b.c)(Ie),m=Object(b.b)(),_=function(){switch(!0){default:return R;case s:return k;case c:return S}};return Object(Be.jsxs)("article",{className:"".concat(r?"cities__place-card":"".concat(_(),"__card")," place-card"),onMouseOver:function(e){r&&(e.preventDefault(),a&&a(t.id))},onMouseOut:function(){a&&a(void 0)},children:[n?Object(Be.jsx)("div",{className:"place-card__mark",children:Object(Be.jsx)("span",{children:"Premium"})}):"",Object(Be.jsx)("div",{className:"".concat(_(),"__image-wrapper place-card__image-wrapper"),children:Object(Be.jsx)(_e.a,{to:{pathname:"".concat(h,"/").concat(j),state:t.id},children:Object(Be.jsx)("img",{className:"place-card__image",src:i,width:s?F:C,height:s?P:A,alt:o})})}),Object(Be.jsxs)("div",{className:"".concat(s?"favorites__card-info":""," place-card__info"),children:[Object(Be.jsxs)("div",{className:"place-card__price-wrapper",children:[Object(Be.jsxs)("div",{className:"place-card__price",children:[Object(Be.jsxs)("b",{className:"place-card__price-value",children:["\u20ac",l]}),Object(Be.jsx)("span",{className:"place-card__price-text",children:"/\xa0night"})]}),Object(Be.jsxs)("button",{className:"place-card__bookmark-button ".concat(p?"place-card__bookmark-button--active":""," button"),type:"button",onClick:function(){return m(ze(f,p,j))},children:[Object(Be.jsx)("svg",{className:"place-card__bookmark-icon",width:"18",height:"19",children:Object(Be.jsx)("use",{xlinkHref:"#icon-bookmark"})}),Object(Be.jsx)("span",{className:"visually-hidden",children:"In bookmarks"})]})]}),Object(Be.jsx)("div",{className:"place-card__rating rating",children:Object(Be.jsxs)("div",{className:"place-card__stars rating__stars",children:[Object(Be.jsx)("span",{style:{width:"".concat(Math.round(u)/5*100,"%")}}),Object(Be.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(Be.jsx)("h2",{className:"place-card__name",children:Object(Be.jsx)(_e.a,{to:{pathname:"".concat(h,"/").concat(j),state:t.id},children:o})}),Object(Be.jsx)("p",{className:"place-card__type",children:g[d.toUpperCase()]})]})]})}var Ye=Object(s.memo)(qe),Je=a(18);var Ke=function(e,t){var a=Object(s.useState)(null),r=Object(me.a)(a,2),c=r[0],n=r[1];return Object(s.useEffect)((function(){if(null!==e.current&&null===c){var a=new Je.Map(e.current,{center:{lat:t.location.latitude,lng:t.location.longitude},zoom:t.location.zoom}),r=new Je.TileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'});a.addLayer(r),n(a)}}),[e,c,t]),c},Qe=(a(74),new Je.Icon({iconUrl:w,iconSize:[28,40],iconAnchor:[14,40]})),Ze=new Je.Icon({iconUrl:E,iconSize:[28,40],iconAnchor:[14,40]});function $e(e){var t=e.offers,a=e.selectedPoint,r=t[0].city,c=t.map((function(e){return{location:e.location,id:e.id}})),n=Object(s.useRef)(null),i=Ke(n,r);return Object(s.useEffect)((function(){i&&c.forEach((function(e){new Je.Marker({lat:e.location.latitude,lng:e.location.longitude}).setIcon(void 0!==a&&e.id===a?Ze:Qe).addTo(i)}))}),[i,c,a]),Object(s.useEffect)((function(){i&&i.setView([r.location.latitude,r.location.longitude])}),[i,r]),Object(Be.jsx)("div",{style:{height:"100%"},ref:n})}var Xe=Object(s.memo)($e);function et(e){var t=e.onSortModeChange,a=e.selectedCity,r="places__option--active",c=Object(s.useState)({isPopular:!0,isPriceUp:!1,isPriceDown:!1,isTopRated:!1}),n=Object(me.a)(c,2),i=n[0],o=n[1],l=Object(s.useState)(!1),u=Object(me.a)(l,2),d=u[0],j=u[1],p=function(){return j((function(e){return!e}))},b=Object(s.useState)(T),f=Object(me.a)(b,2),m=f[0],_=f[1];return Object(s.useEffect)((function(){_(T),j(!1),o({isPopular:!0,isPriceUp:!1,isPriceDown:!1,isTopRated:!1})}),[a]),Object(Be.jsxs)("form",{className:"places__sorting",action:"/",method:"get",children:[Object(Be.jsx)("span",{className:"places__sorting-caption",children:"Sort by"}),Object(Be.jsxs)("span",{onClick:p,className:"places__sorting-type",tabIndex:0,"data-testid":"selectSort",children:[m,Object(Be.jsx)("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:Object(Be.jsx)("use",{xlinkHref:"#icon-arrow-select"})})]}),Object(Be.jsxs)("ul",{onClick:function(e){var a=e.target;p(),a.classList.contains(r)||(_(a.textContent),o({isPopular:a.textContent===T,isPriceUp:a.textContent===I,isPriceDown:a.textContent===U,isTopRated:a.textContent===D}),t(a.textContent))},className:"places__options places__options--custom ".concat(d?"places__options--opened":""),children:[Object(Be.jsx)("li",{className:"places__option ".concat(i.isPopular?r:""),tabIndex:0,children:T}),Object(Be.jsx)("li",{className:"places__option ".concat(i.isPriceUp?r:""),tabIndex:0,children:I}),Object(Be.jsx)("li",{className:"places__option ".concat(i.isPriceDown?r:""),tabIndex:0,children:U}),Object(Be.jsx)("li",{className:"places__option ".concat(i.isTopRated?r:""),tabIndex:0,children:D})]})]})}var tt=Object(s.memo)(et);var at=function(e){var t=e.selectedCity,a=e.offers,r=Object(s.useCallback)((function(e){l(e)}),[]),c=Object(s.useState)(void 0),n=Object(me.a)(c,2),i=n[0],o=n[1],l=function(e){o(e)},u=Object(s.useState)(a),d=Object(me.a)(u,2),j=d[0],p=d[1],b=Object(s.useCallback)((function(e){p(function(e,t){switch(t){case U:return e.slice().sort((function(e,t){return t.price-e.price}));case I:return e.slice().sort((function(e,t){return e.price-t.price}));case D:return e.slice().sort((function(e,t){return t.rating-e.rating}));default:return e.slice()}}(a,e))}),[a]);return Object(s.useEffect)((function(){p(a),window.scrollTo(0,0)}),[a]),Object(s.useEffect)((function(){o(void 0)}),[t]),Object(Be.jsx)("div",{className:"cities",children:Object(Be.jsxs)("div",{className:"cities__places-container container",children:[Object(Be.jsxs)("section",{className:"cities__places places",children:[Object(Be.jsx)("h2",{className:"visually-hidden",children:"Places"}),Object(Be.jsxs)("b",{className:"places__found",children:[1===a.length?"1 place":"".concat(a.length," places")," to stay in ",t]}),Object(Be.jsx)(tt,{onSortModeChange:b,selectedCity:t}),Object(Be.jsx)("div",{className:"cities__places-list places__list tabs__content",children:j.slice().map((function(e){return Object(Be.jsx)(Ye,{offer:e,listItemHoverHandler:r,isMainScreen:!0},e.id)}))})]}),Object(Be.jsx)("div",{className:"cities__right-section",children:Object(Be.jsx)("section",{className:"cities__map map",children:Object(Be.jsx)(Xe,{offers:a,selectedPoint:i})})})]})})};var rt=function(e){var t=e.selectedCity;return Object(Be.jsx)("div",{className:"cities",children:Object(Be.jsxs)("div",{className:"cities__places-container cities__places-container--empty container",children:[Object(Be.jsx)("section",{className:"cities__no-places",children:Object(Be.jsxs)("div",{className:"cities__status-wrapper tabs__content",children:[Object(Be.jsx)("b",{className:"cities__status",children:"No places to stay available"}),Object(Be.jsxs)("p",{className:"cities__status-description",children:["We could not find any property available at the moment in ",t]})]})}),Object(Be.jsx)("div",{className:"cities__right-section"})]})})};var st=function(){var e=Object(b.c)(Ie),t=Object(b.c)(Ue),a=Object(b.b)();return Object(Be.jsx)("nav",{className:"header__nav",children:Object(Be.jsx)("ul",{className:"header__nav-list",children:e===p.Auth?Object(Be.jsxs)(Be.Fragment,{children:[Object(Be.jsx)("li",{className:"header__nav-item user",children:Object(Be.jsxs)(_e.a,{className:"header__nav-link header__nav-link--profile",to:O,children:[Object(Be.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(Be.jsx)("span",{className:"header__user-name user__name",children:t})]})}),Object(Be.jsx)("li",{className:"header__nav-item",children:Object(Be.jsx)("a",{className:"header__nav-link",href:"/",children:Object(Be.jsx)("span",{className:"header__signout",onClick:function(e){e.preventDefault(),a(function(){var e=Object(He.a)(Me.a.mark((function e(t,a,r){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.delete(G),localStorage.removeItem(d),t(be()),t(ue());case 4:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}())},children:"Sign out"})})})]}):Object(Be.jsx)("li",{className:"header__nav-item",children:Object(Be.jsx)(_e.a,{className:"header__nav-link",to:"/login",children:Object(Be.jsx)("span",{className:"header__signout",children:"Sign in"})})})})})};function ct(e){var t=e.isWithUserNavigation;return Object(Be.jsx)("header",{className:"header",children:Object(Be.jsx)("div",{className:"container",children:Object(Be.jsxs)("div",{className:"header__wrapper",children:[Object(Be.jsx)("div",{className:"header__left",children:Object(Be.jsx)(_e.a,{className:"header__logo-link header__logo-link--active",to:m,children:Object(Be.jsx)("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"})})}),t?Object(Be.jsx)(st,{}):""]})})})}var nt=Object(s.memo)(ct);var it=function(){var e=Object(b.c)(Ce),t=Object(b.c)(function(e){return Object(Re.a)(ke,(function(t){return t.filter((function(t){return t.city.name===e}))}))}(e)),a=Object(b.b)(),r=function(e){e.preventDefault();var t=e.target;t.textContent&&a(X(t.textContent))};return Object(Be.jsxs)("div",{className:"page page--gray page--main",children:[Object(Be.jsx)(nt,{isWithUserNavigation:!0}),Object(Be.jsxs)("main",{className:"page__main page__main--index",children:[Object(Be.jsx)("h1",{className:"visually-hidden",children:"Cities"}),Object(Be.jsx)("div",{className:"tabs",children:Object(Be.jsx)("section",{className:"locations container",children:Object(Be.jsx)("ul",{className:"locations__list tabs__list",children:N.map((function(t){return Object(Be.jsx)("li",{className:"locations__item",children:Object(Be.jsx)("a",{className:"locations__item-link tabs__item ".concat(t===e?"tabs__item--active":""),href:"/",onClick:r,children:Object(Be.jsx)("span",{children:t})})},t)}))})})}),0===t.length?Object(Be.jsx)(rt,{selectedCity:e}):Object(Be.jsx)(at,{selectedCity:e,offers:t})]})]})},ot=function(){var e=y(0,N.length-1);return N[e]}();var lt=function(){var e=Object(b.c)(Ie),t=Object(b.b)(),a=Object(s.useRef)(null),r=Object(s.useRef)(null);return e===p.Auth?Object(Be.jsx)(f.a,{to:m}):Object(Be.jsxs)("div",{className:"page page--gray page--login",children:[Object(Be.jsx)(nt,{}),Object(Be.jsx)("main",{className:"page__main page__main--login",children:Object(Be.jsxs)("div",{className:"page__login-container container",children:[Object(Be.jsxs)("section",{className:"login",children:[Object(Be.jsx)("h1",{className:"login__title",children:"Sign in"}),Object(Be.jsxs)("form",{className:"login__form form",action:"#",method:"post",onSubmit:function(e){var s,c;e.preventDefault();var n=function(e,t){var a=e&&K.EMAIL.test(e),r=t&&K.PASSWORD.test(t);return!(!a||!r)}(null===(s=a.current)||void 0===s?void 0:s.value,null===(c=r.current)||void 0===c?void 0:c.value);n?null!==a.current&&null!==r.current&&t(function(e){var t=e.login,a=e.password;return function(){var e=Object(He.a)(Me.a.mark((function e(r,s,c){var n,i;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.post(H,{email:t,password:a});case 2:n=e.sent,i=n.data.token,j(i),r(pe(p.Auth,t)),Le(),r(fe(m));case 8:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()}({login:a.current.value,password:r.current.value})):Ge.b.info("Invalid email or password")},children:[Object(Be.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(Be.jsx)("label",{className:"visually-hidden",children:"E-mail"}),Object(Be.jsx)("input",{ref:a,className:"login__input form__input",type:"email",name:"email","data-testid":"email",placeholder:"Email",required:!0})]}),Object(Be.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(Be.jsx)("label",{className:"visually-hidden",children:"Password"}),Object(Be.jsx)("input",{ref:r,className:"login__input form__input",type:"password",name:"password","data-testid":"password",placeholder:"Password",required:!0})]}),Object(Be.jsx)("button",{className:"login__submit form__submit button",type:"submit","data-testid":"submit",children:"Sign in"})]})]}),Object(Be.jsx)("section",{className:"locations locations--login locations--current",children:Object(Be.jsx)("div",{className:"locations__item",children:Object(Be.jsx)("a",{className:"locations__item-link",href:"/",onClick:function(e){e.preventDefault(),t(X(ot)),t(fe(m))},children:Object(Be.jsx)("span",{children:ot})})})})]})})]})};var ut=function(){return Object(Be.jsx)("footer",{className:"footer",children:Object(Be.jsx)(_e.a,{className:"footer__logo-link",to:m,children:Object(Be.jsx)("img",{className:"footer__logo",src:"img/logo.svg",alt:"6 cities logo",width:"64",height:"33"})})})};var dt=function(){return Object(Be.jsxs)("div",{className:"page page--favorites-empty",children:[Object(Be.jsx)(nt,{isWithUserNavigation:!0}),Object(Be.jsx)("main",{className:"page__main page__main--favorites page__main--favorites-empty",children:Object(Be.jsx)("div",{className:"page__favorites-container container",children:Object(Be.jsxs)("section",{className:"favorites favorites--empty",children:[Object(Be.jsx)("h1",{className:"visually-hidden",children:"Favorites (empty)"}),Object(Be.jsxs)("div",{className:"favorites__status-wrapper",children:[Object(Be.jsx)("b",{className:"favorites__status",children:"Nothing yet saved."}),Object(Be.jsx)("p",{className:"favorites__status-description",children:"Save properties to narrow down search or plan your future trips."})]})]})})}),Object(Be.jsx)(ut,{})]})};var jt=function(){var e=Object(b.c)(Pe),t={};N.map((function(a){var r=e.filter((function(e){return e.city.name===a}));return r.length>0?t[a]=r:null}));var a=Object(b.b)(),r=function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-city");t&&a(X(t)),a(fe(m))};return 0===e.length?Object(Be.jsx)(dt,{}):Object(Be.jsxs)("div",{className:"page",children:[Object(Be.jsx)(nt,{isWithUserNavigation:!0}),Object(Be.jsx)("main",{className:"page__main page__main--favorites",children:Object(Be.jsx)("div",{className:"page__favorites-container container",children:Object(Be.jsxs)("section",{className:"favorites",children:[Object(Be.jsx)("h1",{className:"favorites__title",children:"Saved listing"}),Object(Be.jsx)("ul",{className:"favorites__list",children:Object.entries(t).map((function(e){return Object(Be.jsxs)("li",{className:"favorites__locations-items",children:[Object(Be.jsx)("div",{className:"favorites__locations locations locations--current",children:Object(Be.jsx)("div",{className:"locations__item",children:Object(Be.jsx)("a",{className:"locations__item-link",href:"/",onClick:r,"data-city":e[0],children:Object(Be.jsx)("span",{children:e[0]})})})}),Object(Be.jsx)("div",{className:"favorites__places",children:e[1].map((function(e){return Object(Be.jsx)(Ye,{offer:e,isFavoriteScreen:!0},e.id)}))})]},e[0])}))})]})})}),Object(Be.jsx)(ut,{})]})},pt=a(40),bt=function(e){return e[q.reviews].reviews},ft=function(e){return e[q.reviews].postSuccess},mt=function(e){return e[q.reviews].postError};var _t=function(){var e=Object(f.g)(),t=parseInt(e.id,10),a=Object(b.c)(ft),r=Object(b.c)(mt),c=Object(b.b)(),n=Object(s.useState)({comment:"",rating:0}),i=Object(me.a)(n,2),o=i[0],l=i[1],u=Object(s.useState)(!1),d=Object(me.a)(u,2),j=d[0],p=d[1],m=o.comment,_=o.rating,h=m.length<50||0===_,O=function(e){l({comment:m,rating:parseInt(e.target.value,10)})};return Object(s.useEffect)((function(){a&&(l({comment:"",rating:0}),p(!1),c(ie())),r&&(p(!1),c(oe()))}),[c,r,a]),Object(Be.jsxs)("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:function(e){e.preventDefault(),p(!0),c(function(e,t){return function(){var a=Object(He.a)(Me.a.mark((function a(r,s,c){var n,i;return Me.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.post("".concat(L,"/").concat(e),t);case 3:n=a.sent,i=n.data,r(ce(i)),a.next=12;break;case 8:a.prev=8,a.t0=a.catch(0),Ge.b.info(Q),r(ne());case 12:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e,t,r){return a.apply(this,arguments)}}()}(t,o))},children:[Object(Be.jsx)("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),Object(Be.jsxs)("div",{className:"reviews__rating-form form__rating",children:[Object(Be.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"5",id:"5-stars",type:"radio",onChange:O,checked:5===o.rating,disabled:j}),Object(Be.jsx)("label",{htmlFor:"5-stars",className:"reviews__rating-label form__rating-label",title:"perfect",children:Object(Be.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(Be.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"4",id:"4-stars",type:"radio",onChange:O,checked:4===o.rating,disabled:j}),Object(Be.jsx)("label",{htmlFor:"4-stars",className:"reviews__rating-label form__rating-label",title:"good",children:Object(Be.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(Be.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"3",id:"3-stars",type:"radio",onChange:O,checked:3===o.rating,disabled:j}),Object(Be.jsx)("label",{htmlFor:"3-stars",className:"reviews__rating-label form__rating-label",title:"not bad",children:Object(Be.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(Be.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"2",id:"2-stars",type:"radio",onChange:O,checked:2===o.rating,disabled:j}),Object(Be.jsx)("label",{htmlFor:"2-stars",className:"reviews__rating-label form__rating-label",title:"badly",children:Object(Be.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-star"})})}),Object(Be.jsx)("input",{className:"form__rating-input visually-hidden",name:"rating",value:"1",id:"1-star",type:"radio",onChange:O,checked:1===o.rating,disabled:j}),Object(Be.jsx)("label",{htmlFor:"1-star",className:"reviews__rating-label form__rating-label",title:"terribly",children:Object(Be.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-star"})})})]}),Object(Be.jsx)("textarea",{className:"reviews__textarea form__textarea",id:"review",name:"review",placeholder:"Tell how was your stay, what you like and what can be improved",onChange:function(e){l({comment:e.target.value,rating:_})},value:m,maxLength:300,disabled:j}),Object(Be.jsxs)("div",{className:"reviews__button-wrapper",children:[Object(Be.jsxs)("p",{className:"reviews__help",children:["To submit review please make sure to set ",Object(Be.jsx)("span",{className:"reviews__star",children:"rating"})," and describe your stay with at least ",Object(Be.jsx)("b",{className:"reviews__text-amount",children:"50 characters"}),"."]}),Object(Be.jsx)("button",{className:"reviews__submit form__submit button",type:"submit",disabled:h||j,children:"Submit"})]})]})};var ht=function(e){var t=e.reviews,a=Object(b.c)(Ie),r=t.length>=10?t.slice(t.length-10,t.length).reverse():t.slice().reverse();return Object(Be.jsxs)("section",{className:"property__reviews reviews",children:[Object(Be.jsxs)("h2",{className:"reviews__title",children:["Reviews \xb7 ",Object(Be.jsx)("span",{className:"reviews__amount",children:null===r||void 0===r?void 0:r.length})]}),Object(Be.jsx)("ul",{className:"reviews__list",children:r.map((function(e){var t=new Date(e.date),a=t.toISOString().substring(0,10),r=t.toLocaleString("default",{month:"long",year:"numeric"});return Object(Be.jsxs)("li",{className:"reviews__item",children:[Object(Be.jsxs)("div",{className:"reviews__user user",children:[Object(Be.jsx)("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:Object(Be.jsx)("img",{className:"reviews__avatar user__avatar",src:e.user.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})}),Object(Be.jsx)("span",{className:"reviews__user-name",children:e.user.name})]}),Object(Be.jsxs)("div",{className:"reviews__info",children:[Object(Be.jsx)("div",{className:"reviews__rating rating",children:Object(Be.jsxs)("div",{className:"reviews__stars rating__stars",children:[Object(Be.jsx)("span",{style:{width:"".concat(e.rating/5*100,"%")}}),Object(Be.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(Be.jsx)("p",{className:"reviews__text",children:e.comment}),Object(Be.jsx)("time",{className:"reviews__time",dateTime:a,children:r})]})]},e.id)}))}),a===p.Auth?Object(Be.jsx)(_t,{}):""]})},Ot=a(39),vt=a.n(Ot);var xt=function(){return Object(Be.jsx)("div",{className:vt.a.loader,children:Object(Be.jsx)("div",{className:"visually-hidden",children:"The page is loading"})})};var gt=function(){var e=Object(f.g)(),t=parseInt(e.id,10),a=Object(b.c)(Ae),r=Object(b.c)(Fe),c=Object(b.c)(bt),n=Object(b.c)(Te(t)),i=Object(b.c)(Ie),o=Object(b.b)();if(Object(s.useEffect)((function(){return o(function(e){return function(){var t=Object(He.a)(Me.a.mark((function t(a,r,s){var c,n;return Me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.get("".concat(M,"/").concat(e));case 3:c=t.sent,n=c.data,a(te(n)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),a(fe(v));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,r){return t.apply(this,arguments)}}()}(t)),o(function(e){return function(){var t=Object(He.a)(Me.a.mark((function t(a,r,s){var c,n;return Me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.get("".concat(M,"/").concat(e,"/nearby"));case 2:c=t.sent,n=c.data,a(re(n));case 5:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}()}(t)),o(function(e){return function(){var t=Object(He.a)(Me.a.mark((function t(a,r,s){var c,n;return Me.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.get("".concat(L,"/").concat(e));case 2:c=t.sent,n=c.data,a(se(n));case 5:case"end":return t.stop()}}),t)})));return function(e,a,r){return t.apply(this,arguments)}}()}(t)),window.scrollTo(0,0),function(){o(ae())}}),[o,t]),!a)return Object(Be.jsx)(xt,{});var l=a.images,u=a.isPremium,d=a.title,j=a.rating,p=a.type,m=a.bedrooms,_=a.maxAdults,h=a.price,O=a.goods,x=a.host,N=a.description,y=x.avatarUrl,w=x.isPro,E=x.name;return Object(Be.jsxs)("div",{className:"page",children:[Object(Be.jsx)(nt,{isWithUserNavigation:!0}),Object(Be.jsxs)("main",{className:"page__main page__main--property",children:[Object(Be.jsxs)("section",{className:"property",children:[Object(Be.jsx)("div",{className:"property__gallery-container container",children:Object(Be.jsx)("div",{className:"property__gallery",children:l.slice(0,6).map((function(e){return Object(Be.jsx)("div",{className:"property__image-wrapper",children:Object(Be.jsx)("img",{className:"property__image",src:e,alt:"Property"})},e)}))})}),Object(Be.jsx)("div",{className:"property__container container",children:Object(Be.jsxs)("div",{className:"property__wrapper",children:[u?Object(Be.jsx)("div",{className:"property__mark",children:Object(Be.jsx)("span",{children:"Premium"})}):"",Object(Be.jsxs)("div",{className:"property__name-wrapper",children:[Object(Be.jsx)("h1",{className:"property__name",children:d}),Object(Be.jsxs)("button",{className:"property__bookmark-button ".concat(n?"property__bookmark-button--active":""," button"),type:"button",onClick:function(){return o(ze(i,n,t))},children:[Object(Be.jsx)("svg",{className:"property__bookmark-icon",width:"31",height:"33",children:Object(Be.jsx)("use",{xlinkHref:"#icon-bookmark"})}),Object(Be.jsx)("span",{className:"visually-hidden",children:"To bookmarks"})]})]}),Object(Be.jsxs)("div",{className:"property__rating rating",children:[Object(Be.jsxs)("div",{className:"property__stars rating__stars",children:[Object(Be.jsx)("span",{style:{width:"".concat(Math.round(j)/5*100,"%")}}),Object(Be.jsx)("span",{className:"visually-hidden",children:"Rating"})]}),Object(Be.jsx)("span",{className:"property__rating-value rating__value",children:Math.round(j)})]}),Object(Be.jsxs)("ul",{className:"property__features",children:[Object(Be.jsx)("li",{className:"property__feature property__feature--entire",children:g[p.toUpperCase()]}),Object(Be.jsx)("li",{className:"property__feature property__feature--bedrooms",children:1===m?"1 Bedroom":"".concat(m," Bedrooms")}),Object(Be.jsxs)("li",{className:"property__feature property__feature--adults",children:["Max ",_," adults"]})]}),Object(Be.jsxs)("div",{className:"property__price",children:[Object(Be.jsxs)("b",{className:"property__price-value",children:["\u20ac",h]}),Object(Be.jsx)("span",{className:"property__price-text",children:"\xa0night"})]}),Object(Be.jsxs)("div",{className:"property__inside",children:[Object(Be.jsx)("h2",{className:"property__inside-title",children:"What's inside"}),Object(Be.jsx)("ul",{className:"property__inside-list",children:O.map((function(e){return Object(Be.jsx)("li",{className:"property__inside-item",children:e},e)}))})]}),Object(Be.jsxs)("div",{className:"property__host",children:[Object(Be.jsx)("h2",{className:"property__host-title",children:"Meet the host"}),Object(Be.jsxs)("div",{className:"property__host-user user",children:[Object(Be.jsx)("div",{className:"property__avatar-wrapper property__avatar-wrapper--pro user__avatar-wrapper",children:Object(Be.jsx)("img",{className:"property__avatar user__avatar",src:y,width:"74",height:"74",alt:"Host avatar"})}),Object(Be.jsx)("span",{className:"property__user-name",children:E}),w?Object(Be.jsx)("span",{className:"property__user-status",children:"Pro"}):""]}),Object(Be.jsx)("div",{className:"property__description",children:Object(Be.jsx)("p",{className:"property__text",children:N})})]}),c?Object(Be.jsx)(ht,{reviews:c}):""]})}),Object(Be.jsx)("section",{className:"property__map map",children:r?Object(Be.jsx)(Xe,{offers:[a].concat(Object(pt.a)(r)),selectedPoint:t}):""})]}),Object(Be.jsx)("div",{className:"container",children:Object(Be.jsxs)("section",{className:"near-places places",children:[Object(Be.jsx)("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),Object(Be.jsx)("div",{className:"near-places__list places__list",children:r?r.map((function(e){return Object(Be.jsx)(Ye,{offer:e,isPropertyScreen:!0},e.id)})):""})]})})]})]})};var Nt=function(){return Object(Be.jsxs)("div",{className:"page page--favorites-empty",children:[Object(Be.jsx)("main",{className:"page__main page__main--favorites-empty",children:Object(Be.jsx)("div",{className:"page__favorites-container container",children:Object(Be.jsx)("section",{className:"favorites favorites--empty",children:Object(Be.jsx)("h1",{style:{textAlign:"center"},children:"404 Page Not Found"})})})}),Object(Be.jsx)(ut,{})]})};var yt=function(e){var t=e.exact,a=e.path,r=e.render,s=Object(b.c)(Ie);return Object(Be.jsx)(f.b,{exact:t,path:a,render:function(){return s===p.Auth?r():Object(Be.jsx)(f.a,{to:_})}})};var wt=function(){var e=Object(b.c)(Ie),t=Object(b.c)(Se);return function(e){return e===p.Unknown}(e)||!t?Object(Be.jsx)(xt,{}):Object(Be.jsxs)(f.d,{children:[Object(Be.jsx)(f.b,{path:m,exact:!0,children:Object(Be.jsx)(it,{})}),Object(Be.jsx)(f.b,{path:_,exact:!0,children:Object(Be.jsx)(lt,{})}),Object(Be.jsx)(yt,{exact:!0,path:O,render:function(){return Object(Be.jsx)(jt,{})}}),Object(Be.jsx)(f.b,{path:"".concat(h,"/:id"),children:Object(Be.jsx)(gt,{})}),Object(Be.jsx)(f.b,{path:v,children:Object(Be.jsx)(Nt,{})}),Object(Be.jsx)(f.b,{children:Object(Be.jsx)(Nt,{})})]})},Et=a(9),Rt=Object(Et.a)(),kt=function(e){return function(e){return function(t){return t.type===x.RedirectToRoute&&Rt.push(t.payload.url),e(t)}}},St=(a(75),function(e){var t=u.a.create({baseURL:"https://8.react.pages.academy/six-cities",timeout:5e3});return t.interceptors.response.use((function(e){return e}),(function(t){var a=t.response;return(null===a||void 0===a?void 0:a.status)===r.Unauthorized?e():Promise.reject(t)})),t.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(d);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),t}((function(){return Ct.dispatch(pe(p.NoAuth))}))),Ct=Object(o.a)({reducer:Ee,middleware:function(e){return e({thunk:{extraArgument:St}}).concat(kt)}});Ct.dispatch(function(){var e=Object(He.a)(Me.a.mark((function e(t,a,r){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(H).then((function(e){e.data&&t(pe(p.Auth,e.data.email))}));case 2:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()),Ct.dispatch(function(){var e=Object(He.a)(Me.a.mark((function e(t,a,r){var s,c;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(M);case 2:s=e.sent,c=s.data,t(ee(c));case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()),Ct.dispatch(Le()),i.a.render(Object(Be.jsx)(c.a.StrictMode,{children:Object(Be.jsx)(b.a,{store:Ct,children:Object(Be.jsxs)(f.c,{history:Rt,children:[Object(Be.jsx)(Ge.a,{}),Object(Be.jsx)(wt,{})]})})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.c593de06.chunk.js.map